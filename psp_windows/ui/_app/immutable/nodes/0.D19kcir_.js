import{g as ve,b as me}from"../chunks/Cj9tYCJl.js";import{l as re,h as ie,c as G,b as c,p as r,f as b,i as I,n as Ae,d as be,a as W,g as Me}from"../chunks/CAJyC1Oe.js";import{f as x,p as Q,c as S,r as y,t as j,e as ee,b as D,g as F,u as H,m as Se,C as Ne}from"../chunks/BNhJgPkb.js";import{h as we,b as Z,d as te,i as Oe,j as Ce,a as Ge,t as Le,k as Fe}from"../chunks/DYcuc4uV.js";import{I as oe,b as de,S as pe,g as k,P as Ie,U as Be,V as He,N as Ee,W as je,e as _e,M as h,t as Ve,a as ce,X as Re,O as Ue,q as se,B as ze,D as Je,E as We,Y as Ye,G as Ze,z as $e,Z as qe,h as Ke,_ as Xe,$ as Qe,a0 as ea}from"../chunks/E3TZ2KYB.js";import{p as aa}from"../chunks/C_TIRcGc.js";import{I as ta,t as sa}from"../chunks/CdByRzLc.js";import{S as la}from"../chunks/D7G_gR68.js";import{b as na}from"../chunks/DdltcTOJ.js";import{m as ra}from"../chunks/DkCIVBzI.js";const ia=!1,oa=!0;function da(s){return["edit","info","file","settings","loading","error","browser","about","upload"].includes(s)}const ca=({url:s})=>{const e=s.searchParams.get("path");if(e){const a=decodeURIComponent(e);da(a.replace(/^\//,""))?ve(`${me}${a}`):(console.warn(`Invalid path: ${a}, redirecting to base path ${me}`),ve(me))}},xt=Object.freeze(Object.defineProperty({__proto__:null,load:ca,prerender:oa,ssr:ia},Symbol.toStringTag,{value:"Module"}));function fa(s,e){const a=re(e,["children","$$slots","$$events","$$legacy"]);oe(s,ie({name:"file-heart"},()=>a,{iconNode:[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v2"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["path",{d:"M10.29 10.7a2.43 2.43 0 0 0-2.66-.52c-.29.12-.56.3-.78.53l-.35.34-.35-.34a2.43 2.43 0 0 0-2.65-.53c-.3.12-.56.3-.79.53-.95.94-1 2.53.2 3.74L6.5 18l3.6-3.55c1.2-1.21 1.14-2.8.19-3.74Z"}]],children:(t,i)=>{var l=G(),o=x(l);de(o,e,"default",{},null),c(t,l)},$$slots:{default:!0}}))}function va(s,e){const a=re(e,["children","$$slots","$$events","$$legacy"]);oe(s,ie({name:"file"},()=>a,{iconNode:[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}]],children:(t,i)=>{var l=G(),o=x(l);de(o,e,"default",{},null),c(t,l)},$$slots:{default:!0}}))}function ua(s,e){const a=re(e,["children","$$slots","$$events","$$legacy"]);oe(s,ie({name:"map"},()=>a,{iconNode:[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z"}],["path",{d:"M15 5.764v15"}],["path",{d:"M9 3.236v15"}]],children:(t,i)=>{var l=G(),o=x(l);de(o,e,"default",{},null),c(t,l)},$$slots:{default:!0}}))}function ha(s,e){const a=re(e,["children","$$slots","$$events","$$legacy"]);oe(s,ie({name:"pencil"},()=>a,{iconNode:[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}],["path",{d:"m15 5 4 4"}]],children:(t,i)=>{var l=G(),o=x(l);de(o,e,"default",{},null),c(t,l)},$$slots:{default:!0}}))}function ga(s,e){const a=re(e,["children","$$slots","$$events","$$legacy"]);oe(s,ie({name:"settings"},()=>a,{iconNode:[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}],["circle",{cx:"12",cy:"12",r:"3"}]],children:(t,i)=>{var l=G(),o=x(l);de(o,e,"default",{},null),c(t,l)},$$slots:{default:!0}}))}var ma=b('<nav data-testid="nav-bar-tileset"><!></nav>'),_a=b('<aside data-testid="nav-bar"><!></aside>');function pa(s,e){Q(e,!0);const a=r(e,"base",3,"flex flex-col"),n=r(e,"background",3,"preset-filled-surface-100-900"),t=r(e,"width",3,"min-w-[320px] w-full"),i=r(e,"height",3,"h-20"),l=r(e,"padding",3,"p-1"),o=r(e,"classes",3,""),d=r(e,"tilesBase",3,"flex-1 flex"),_=r(e,"tilesFlexDirection",3,""),w=r(e,"tilesJustify",3,"justify-center"),V=r(e,"tilesItems",3,"items-center"),R=r(e,"tilesGap",3,"gap-1"),E=r(e,"tilesClasses",3,"");we({parent:"bar",get value(){return e.value},expanded:!1,get onValueChange(){return e.onValueChange}});var u=_a(),A=S(u);{var P=v=>{var g=ma(),N=S(g);te(N,()=>e.children),y(g),j(()=>Z(g,1,`${d()??""} ${_()??""} ${w()??""} ${V()??""} ${R()??""} ${E()??""}`)),c(v,g)};I(A,v=>{e.children&&v(P)})}y(u),j(()=>Z(u,1,`${a()??""} ${n()??""} ${t()??""} ${i()??""} ${l()??""} ${o()??""}`)),c(s,u),ee()}var ya=b('<header data-testid="nav-rail-header"><!></header>'),ba=b('<nav data-testid="nav-rail-tiles"><!></nav>'),xa=b('<footer data-testid="nav-rail-footer"><!></footer>'),Sa=b('<aside data-testid="nav-rail"><!> <!> <!></aside>');function xe(s,e){Q(e,!0);const a=r(e,"value",3,""),n=r(e,"expanded",3,!1),t=r(e,"base",3,"h-full flex flex-col"),i=r(e,"background",3,"preset-filled-surface-100-900"),l=r(e,"padding",3,"p-1"),o=r(e,"width",3,"w-24"),d=r(e,"widthExpanded",3,"w-64"),_=r(e,"height",3,"h-full"),w=r(e,"classes",3,""),V=r(e,"headerBase",3,"flex"),R=r(e,"headerFlexDirection",3,"flex-col"),E=r(e,"headerJustify",3,"justify-center"),u=r(e,"headerItems",3,"items-center"),A=r(e,"headerGap",3,"gap-1"),P=r(e,"headerClasses",3,""),v=r(e,"tilesBase",3,"flex-1 flex"),g=r(e,"tilesFlexDirection",3,"flex-col"),N=r(e,"tilesJustify",3,"justify-center"),$=r(e,"tilesItems",3,"items-center"),q=r(e,"tilesGap",3,"gap-1"),X=r(e,"tilesClasses",3,""),O=r(e,"footerBase",3,"flex"),f=r(e,"footerFlexDirection",3,"flex-col"),m=r(e,"footerJustify",3,"justify-center"),T=r(e,"footerItems",3,"items-center"),L=r(e,"footerGap",3,"gap-1"),U=r(e,"footerClasses",3,"");we({parent:"rail",get value(){return a()},get expanded(){return n()},get onValueChange(){return e.onValueChange}});let z=H(()=>n()?d():o());var J=Sa(),fe=S(J);{var ue=M=>{var p=ya(),K=S(p);te(K,()=>e.header),y(p),j(()=>Z(p,1,`${V()??""} ${R()??""} ${E()??""} ${u()??""} ${A()??""} ${P()??""}`)),c(M,p)};I(fe,M=>{e.header&&M(ue)})}var le=D(fe,2);{var he=M=>{var p=ba(),K=S(p);te(K,()=>e.tiles),y(p),j(()=>Z(p,1,`${v()??""} ${g()??""} ${N()??""} ${$()??""} ${q()??""} ${X()??""}`)),c(M,p)};I(le,M=>{e.tiles&&M(he)})}var ae=D(le,2);{var ge=M=>{var p=xa(),K=S(p);te(K,()=>e.footer),y(p),j(()=>Z(p,1,`${O()??""} ${f()??""} ${m()??""} ${T()??""} ${L()??""} ${U()??""}`)),c(M,p)};I(ae,M=>{e.footer&&M(ge)})}y(J),j(()=>Z(J,1,`${t()??""} ${i()??""} ${_()??""} ${l()??""} ${F(z)??""} ${w()??""}`)),c(s,J),ee()}var wa=b("<div><!></div>"),Ea=b('<div data-testid="nav-tile-label"> </div>'),Pa=b('<div data-testid="nav-tile-label-expanded"> </div>'),Ta=b("<!> <!> <!>",1);function Da(s,e){const a=Ae();Q(e,!0);const n=r(e,"id",3,a),t=r(e,"selected",3,void 0),i=r(e,"type",3,"button"),l=r(e,"base",3,"flex items-center"),o=r(e,"width",3,"w-full"),d=r(e,"aspect",3,"aspect-square"),_=r(e,"background",3,""),w=r(e,"hover",3,"hover:preset-filled-surface-50-950"),V=r(e,"active",3,"preset-filled-primary-500"),R=r(e,"padding",3,"p-2"),E=r(e,"gap",3,"gap-1"),u=r(e,"rounded",3,"rounded-container"),A=r(e,"classes",3,"flex-col justify-center"),P=r(e,"expandedPadding",3,"py-3 px-4"),v=r(e,"expandedGap",3,"gap-4"),g=r(e,"expandedClasses",3,""),N=r(e,"labelBase",3,"text-xs"),$=r(e,"labelClasses",3,""),q=r(e,"labelExpandedBase",3,""),X=r(e,"labelExpandedClasses",3,""),O=Oe(),f=H(()=>e.href?"a":"button"),m=H(()=>e.href?void 0:"button"),T=H(()=>O.parent==="bar"?"h-full":`${d()}`),L=H(()=>`${F(T)} ${R()} ${E()} ${A()}`),U=H(()=>`${P()} ${v()} ${g()}`),z=H(()=>O.expanded?F(U):F(L)),J=H(()=>t()!==void 0?t():O.value===n()),fe=H(()=>F(J)?V():`${_()} ${w()}`);function ue(){var ae;if(e.onclick&&!n())throw new Error("No ID was provided");e.onclick&&n()&&e.onclick(n()),(ae=O.onValueChange)==null||ae.call(O,n())}var le=G(),he=x(le);Ce(he,()=>F(f),!1,(ae,ge)=>{let M;j(()=>M=Ge(ae,M,{class:`${l()??""} ${o()??""} ${u()??""} ${F(fe)??""} ${F(z)??""}`,href:e.href,target:e.target,type:F(f)==="button"?i():void 0,title:e.title,role:F(m),onclick:ue,tabindex:"0","data-testid":"nav-tile"}));var p=Ta(),K=x(p);{var Pe=B=>{var C=wa(),ne=S(C);te(ne,()=>e.children),y(C),c(B,C)};I(K,B=>{e.children&&B(Pe)})}var ye=D(K,2);{var Te=B=>{var C=Ea(),ne=S(C,!0);y(C),j(()=>{Z(C,1,`${N()??""} ${$()??""}`),be(ne,e.label)}),c(B,C)};I(ye,B=>{e.label&&!O.expanded&&B(Te)})}var De=D(ye,2);{var ke=B=>{var C=Pa(),ne=S(C,!0);y(C),j(()=>{Z(C,1,`${q()??""} ${X()??""}`),be(ne,e.labelExpanded)}),c(B,C)};I(De,B=>{e.labelExpanded&&O.expanded&&B(ke)})}c(ge,p)}),c(s,le),ee()}const Y=Object.assign(xe,{Rail:xe,Bar:pa,Tile:Da});var ka=b("<!> <!> <!> <!> <!> <!>",1);function Aa(s,e){Q(e,!0);let a=pe(),n=k(),t=Ee();Se(()=>{const{id:d}=aa.route;a.navigateTo(d==null?void 0:d.replace("/",""))});async function i(){await t.showModal(je,{title:"Settings",settings:n.settings})&&(_e(h.UPDATE_SETTINGS,{...n.settings}),setTimeout(()=>{location.reload()},500))}var l=G(),o=x(l);W(o,()=>Y.Rail,(d,_)=>{_(d,{width:"48px",get value(){return a.activePage},onValueChange:E=>a.navigateToAndSave(E),header:E=>{var u=G(),A=x(u);{var P=v=>{var g=G(),N=x(g);W(N,()=>Y.Tile,($,q)=>{q($,{label:"Save",labelBase:"text-xs",title:"Save",id:"save",onclick:()=>n.writeSave(),children:(X,O)=>{He(X,{})},$$slots:{default:!0}})}),c(v,g)};I(A,v=>{n.saveFile&&Ie==="true"&&v(P)})}c(E,u)},tiles:E=>{var u=ka(),A=x(u);{var P=f=>{var m=G(),T=x(m);W(T,()=>Y.Tile,(L,U)=>{U(L,{label:"Edit",labelBase:"text-xs",title:"Edit",id:"edit",href:"/edit",active:"bg-secondary-500",children:(z,J)=>{ha(z,{})},$$slots:{default:!0}})}),c(f,m)};I(A,f=>{n.saveFile&&f(P)})}var v=D(A,2);{var g=f=>{var m=G(),T=x(m);W(T,()=>Y.Tile,(L,U)=>{U(L,{label:"Files",labelBase:"text-xs",title:"File",id:"file",href:"/file",active:"bg-secondary-500",children:(z,J)=>{va(z,{})},$$slots:{default:!0}})}),c(f,m)};I(v,f=>{f(g)})}var N=D(v,2);W(N,()=>Y.Tile,(f,m)=>{m(f,{label:"Map",labelBase:"text-xs",title:"Map",id:"map",href:"/worldmap",active:"bg-secondary-500",children:(T,L)=>{ua(T,{})},$$slots:{default:!0}})});var $=D(N,2);W($,()=>Y.Tile,(f,m)=>{m(f,{label:"About",labelBase:"text-xs",title:"About",id:"about",href:"/about",active:"bg-secondary-500",children:(T,L)=>{ta(T,{})},$$slots:{default:!0}})});var q=D($,2);W(q,()=>Y.Tile,(f,m)=>{m(f,{label:"Presets",labelBase:"text-xs",title:"Presets",id:"presets",href:"/presets",active:"bg-secondary-500",children:(T,L)=>{fa(T,{})},$$slots:{default:!0}})});var X=D(q,2);{var O=f=>{var m=G(),T=x(m);W(T,()=>Y.Tile,(L,U)=>{U(L,{label:"Debug",labelBase:"text-xs",title:"Debug",id:"debug",href:"/debug",active:"bg-secondary-500",children:(z,J)=>{Be(z,{})},$$slots:{default:!0}})}),c(f,m)};I(X,f=>{n.settings.debug_mode&&f(O)})}c(E,u)},footer:E=>{var u=G(),A=x(u);W(A,()=>Y.Tile,(P,v)=>{v(P,{label:"Settings",labelBase:"text-xs",title:"Settings",id:"settings",onclick:i,children:(g,N)=>{ga(g,{})},$$slots:{default:!0}})}),c(E,u)},$$slots:{header:!0,tiles:!0,footer:!0}})}),c(s,l),ee()}var Ma=b("<div></div>");function Na(s,e){Q(e,!0);let a=r(e,"position",3,"top-right"),n=r(e,"transition",19,()=>({type:"fly",params:{x:300}}));const t=ce();Se(()=>{t.setPosition(a()),t.setTransition(n())});let i=H(()=>({"top-center":"top-4 left-1/2 transform -translate-x-1/2","top-right":"top-4 right-4","top-left":"top-4 left-4","bottom-right":"bottom-4 right-4","bottom-left":"bottom-4 left-4","bottom-center":"bottom-4 left-1/2 transform -translate-x-1/2"})[t.position]);var l=Ma();Ve(l,21,()=>t.toasts,o=>o.id,(o,d)=>{Re(o,{get toast(){return F(d)}})}),y(l),j(()=>Z(l,1,`toast-content fixed flex flex-col gap-2 ${F(i)??""}`,"svelte-1smmv0i")),c(s,l),ee()}const Oa=async()=>{await Ue.reset(),await se.reset(),await ze.reset(),await Je.reset(),await sa.reset(),await We.reset(),await Ye.reset(),await Ze.reset(),await $e.reset(),await na.reset(),await ra.reset(),await qe.reset(),_e(h.GET_VERSION),_e(h.SYNC_APP_STATE)};function Ca(s,e){e.closeModal(null)}var Ga=b('<div class="flex flex-col space-y-4 p-4"><h3 class="h3">Update Available!</h3> <p class="my-4">A new version of Palworld Save Pal is available on GitHub.</p> <div class="mt-2 flex flex-row items-center justify-end space-x-2"><a href="https://github.com/oMaN-Rod/palworld-save-pal/releases" target="_blank" rel="noopener noreferrer" class="btn btn-primary">Update Now</a> <button class="btn hover:bg-secondary-500">Later</button></div></div>'),La=b('<div class="flex h-full w-full flex-col items-center justify-center space-y-4"><!></div>');function Fa(s,e){Q(e,!0);var a=La(),n=S(a);Ke(n,{class:"min-w-[calc(100vw/3)]",children:(t,i)=>{var l=Ga(),o=D(S(l),4),d=D(S(o),2);d.__click=[Ca,e],y(o),y(l),c(t,l)},$$slots:{default:!0}}),y(a),c(s,a),ee()}Me(["click"]);async function Ia(s){try{const e=await fetch("https://api.github.com/repos/oMaN-Rod/palworld-save-pal/releases/latest");if(!e.ok)throw new Error(`GitHub API error: ${e.status} ${e.statusText}`);const n=(await e.json()).tag_name.replace(/^v/,""),t=s.replace(/^v/,"");return Ba(n,t)}catch(e){const a=e instanceof Error?e.message:String(e);throw new Error(`Failed to check for updates: ${a}`)}}function Ba(s,e){const a=s.split(".").map(i=>parseInt(i)||0),n=e.split(".").map(i=>parseInt(i)||0),t=Math.max(a.length,n.length);for(;a.length<t;)a.push(0);for(;n.length<t;)n.push(0);for(let i=0;i<t;i++){if(a[i]>n[i])return!0;if(a[i]<n[i])return!1}return!1}const Ha={type:h.PROGRESS_MESSAGE,async handle(s){const e=k();e.progressMessage=s}},ja={type:h.GET_VERSION,async handle(s){const e=k(),a=Ee();e.version=s,await Ia(s)&&await a.showModal(Fa,{})}},Va={type:h.ERROR,async handle(s){const e=s;ve("/error",{state:{message:e.message,trace:e.trace}})}},Ra={type:h.GET_SETTINGS,async handle(s){const e=k();e.settings=s}},Ua=[ja,Ha,Va,Ra],za={type:h.GET_GUILDS,async handle(s,{goto:e}){const a=k(),n=await Promise.all(Object.entries(s).map(async([t,i])=>{try{return i.bases&&await Promise.all(Object.values(i.bases).map(async l=>{l.pals&&await Promise.all(Object.values(l.pals).map(async o=>{const d=se.pals[o.character_key];d||console.error("Failed to find pal info for",JSON.parse(JSON.stringify(o))),o.name=(d==null?void 0:d.localized_name)||o.character_id}))})),[t,i]}catch(l){return console.error(`Failed to parse guild data for key ${t}:`,l),null}}));a.guilds=Object.fromEntries(n.filter(t=>t!==null)),console.log(`Loaded ${Object.keys(a.guilds).length} guilds`),await e("/edit")}},Ja={type:h.DELETE_GUILD,async handle(s,{goto:e}){const a=k(),n=ce();console.log(`Deleting guild ${JSON.stringify(s)}`);const{guild_id:t,origin:i}=s;a.selectedPlayer=void 0,a.selectedPal=void 0;const l=a.guilds[t],o=(l==null?void 0:l.name)||"Unknown Guild";a.players=Object.fromEntries(Object.entries(a.players).filter(([d])=>{var _;return((_=l.players)==null?void 0:_.includes(d))!==!0})),delete a.guilds[t],n.add(`Guild ${o} deleted`,void 0,"success"),await e(`/${i}`)}},Wa=[Ja,za],Ya={type:h.ADD_PAL,async handle(s){const{player_id:e,guild_id:a,base_id:n,pal:t}=s,i=k(),l=pe();if(t){if(e&&i.players){const o=se.pals[t.character_key];t.name=(o==null?void 0:o.localized_name)||t.character_id,t.elements=(o==null?void 0:o.element_types)||[],i.players[e].pals[t.instance_id]=t}if(a&&i.guilds){const o=se.pals[t.character_key];t.name=(o==null?void 0:o.localized_name)||t.character_id,t.elements=(o==null?void 0:o.element_types)||[],i.guilds[a].bases[n].pals[t.instance_id]=t}i.selectedPal=t,l.activeTab="pal"}}},Za={type:h.ADD_DPS_PAL,async handle(s){const{player_id:e,pal:a,index:n}=s,t=k(),i=pe();if(a){if(e&&t.players){const l=se.pals[a.character_key];a.name=(l==null?void 0:l.localized_name)||a.character_id,a.elements=(l==null?void 0:l.element_types)||[],t.players[e].dps&&(t.players[e].dps[n]=a)}t.selectedPal=a,i.activeTab="pal"}}},$a={type:h.MOVE_PAL,async handle(s){const e=k(),a=s;if(e.players&&e.players[a.player_id]){const n=e.players[a.player_id],t=n.pals?n.pals[a.pal_id]:void 0;t&&(t.storage_id=a.container_id,t.storage_slot=a.slot_index)}}},qa=[Ya,$a,Za],Ka={type:h.GET_PLAYERS,async handle(s){const e=k(),a=await Promise.all(Object.entries(s).map(async([n,t])=>{try{return t.pals&&Object.values(t.pals).map(i=>{const l=se.pals[i.character_key];l||console.error("Failed to find pal info for",JSON.parse(JSON.stringify(i))),i.name=(l==null?void 0:l.localized_name)||i.character_id}),[n,t]}catch(i){return console.error(`Failed to parse player data for key ${n}:`,i),null}}));e.players=Object.fromEntries(a.filter(n=>n!==null))}},Xa={type:h.DELETE_PLAYER,async handle(s,{goto:e}){var o;const a=k(),n=ce(),{player_id:t,origin:i}=s;if(!s){n.add("Cannot delete guild admin player, you must delete the entire guild or transfer admin to another player","Error","error");return}a.selectedPlayer=void 0,a.selectedPal=void 0;const l=((o=a.players[t])==null?void 0:o.nickname)||"Unknown Player";delete a.players[t],Object.values(a.guilds).forEach(d=>{d.players=d.players.filter(_=>_!==t)}),n.add(`Player ${l} deleted`,void 0,"success"),e(`/${i}`)}},Qa=[Xa,Ka],et={type:h.NO_FILE_SELECTED,async handle(s,{goto:e}){ce().add("No file was selected","Warning","warning"),await e("/file")}},at={type:h.LOADED_SAVE_FILES,async handle(s){const e=k(),{level:a,players:n,world_name:t,size:i,type:l}=s;console.log("Loaded save files",a,n),e.resetState(),e.saveFile={name:a,world_name:t,type:l},e.playerSaveFiles=n.map(o=>({name:o}))}},tt={type:h.SAVE_MODDED_SAVE,async handle(s,{goto:e}){ce().add(s,"Saved!","success"),await e("/file")}},st={type:h.DOWNLOAD_SAVE_FILE,async handle(s,{goto:e}){console.log("Download save files",s);const a=s;for(const{name:n,content:t}of a){const i=atob(t),l=new Uint8Array(i.length);for(let w=0;w<i.length;w++)l[w]=i.charCodeAt(w);const o=new Blob([l],{type:"application/octet-stream"}),d=URL.createObjectURL(o),_=document.createElement("a");_.href=d,_.download=n,_.click(),URL.revokeObjectURL(d)}await e("/file")}},lt={type:h.UPDATE_SAVE_FILE,async handle(s){const e=k();console.log("Save file updated",s),await new Promise(a=>setTimeout(a,500)),e.autoSave=!1}},nt={type:h.SELECT_GAMEPASS_SAVE,async handle(s,{goto:e}){const a=k();a.resetState(),a.gamepassSaves=s,await e("/file")}},rt=[at,tt,st,lt,et,nt],it=[...Ua,...rt,...qa,...Qa,...Wa];var ot=b('<div class="absolute right-2 top-1 flex shrink-0 flex-row"><div class="flex items-center space-x-2 rounded-full p-3"><span class="text-lg font-bold">Syncing</span> <!></div></div>'),dt=b('<div class="flex h-screen w-full overflow-hidden"><!> <!> <main class="flex-1 overflow-hidden"><!></main></div>'),ct=b("<!> <!>",1);function St(s,e){Q(e,!0);const a=ea(),n=Xe(),t=k();it.forEach(d=>{n.register(d)}),Ne(async()=>{a.connect({goto:ve}),await Oa()});var i=ct(),l=x(i);Na(l,{position:"bottom-center",transition:{type:"fly",params:{y:300}}});var o=D(l,2);Qe(o,{children:(d,_)=>{var w=dt(),V=S(w);Aa(V,{});var R=D(V,2);{var E=P=>{var v=ot(),g=S(v),N=D(S(g),2);la(N,{size:"size-6"}),y(g),y(v),Le(3,v,()=>Fe),c(P,v)};I(R,P=>{t.autoSave&&P(E)})}var u=D(R,2),A=S(u);te(A,()=>e.children),y(u),y(w),c(d,w)},$$slots:{default:!0}}),c(s,i),ee()}export{St as component,xt as universal};
